<nav class="navbar navbar-expand-lg bg-white shadow-sm px-4 py-3">
  <div class="container-fluid">
    <a class="navbar-brand fw-bold text-danger fs-4" href="#">
      <span class="text-dark">Vraj</span>Bus
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <div class="ms-auto d-flex align-items-center gap-4">
        <a class="nav-link text-dark fw-semibold" href="#"  routerLink="/">Home</a>
        <a class="nav-link text-dark fw-semibold" href="#"  routerLink="/blog">Blog</a>
        <a class="nav-link text-dark fw-semibold" href="#" routerLink="/help">Help center</a>
        <a class="nav-link text-dark fw-semibold" href="#" routerLink="/login">My bookings</a>
        <button class="btn btn-danger btn-sm rounded-pill px-3" routerLink="/user" style="margin-left: 0px;">
          User Account        </button>
        <button class="btn btn-success btn-sm rounded-pill px-3" routerLink="/adminview">
          Admin Account
        </button>
      </div>
    </div>
  </div>
</nav>

<div class="container mt-5">
  <div class="row mb-6 g-3">
     <div class="col-md-2 d-flex align-items-end">
     <!--<button class="btn btn-secondary w-100" (click)="resetFilters()"></button>-->
    </div>

    <div class="col-md-3">
      <label class="form-label fw-bold">Filter by Date:</label>
      <select class="form-select" [(ngModel)]="selectedDate" (ngModelChange)="applyFilters()">
        <option value="">All Dates</option>
        <option *ngFor="let date of uniqueDates" [value]="date">{{ date }}</option>
      </select>
    </div>

    <div class="col-md-3">
      <label class="form-label fw-bold">Filter by Bus:</label>
      <select class="form-select" [(ngModel)]="selectedBus" (ngModelChange)="applyFilters()">
        <option value="">All Buses</option>
        <option *ngFor="let bus of buses" [value]="bus">{{ bus }}</option>
      </select>
    </div>

    <div class="col-md-4">
      <label class="form-label fw-bold">Search:</label>
      <input
        type="text"
        class="form-control"
        placeholder="Search by Customer Name or Email"
        [(ngModel)]="searchTerm"
        (input)="applyFilters()"
      />
    </div>

    <div class="col-md-2 d-flex align-items-end">
<button class="btn btn-secondary w-100" routerLink="/admin-bus">BUS</button>
    </div>
    <div class="col-md-2 d-flex align-items-end">
<button class="btn btn-secondary w-100" routerLink="/uquery">QUERY</button>
    </div>
  </div>

  <div *ngIf="loading" class="text-center my-4">
    <div class="spinner-border text-primary" role="status"></div>
    <p>Loading bookings...</p>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div *ngFor="let group of filteredGroupedBookings">
    <h4 class="mt-4 text-primary">Date: {{ group.date }}</h4>

    <table class="table table-striped table-bordered">
      <thead class="table-dark">
        <tr>
          <th>ID</th>
          <th>User ID</th>
          <th>Bus ID</th>
          <th>Customer</th>
          <th>Email</th>
          <th>Bus</th>
          <th>From</th>
          <th>To</th>
          <th>Seats</th>
          <th>Total Price</th>
          <th>Action</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let booking of group.bookings">
          <td>{{ booking.id }}</td>
          <td>{{ booking.userId }}</td>
          <td>{{ booking.busId }}</td>
          <td>{{ booking.customerName }}</td>
          <td>{{ booking.email }}</td>
          <td>{{ booking.busName }}</td>
          <td>{{ booking.fromLocation }}</td>
          <td>{{ booking.toLocation }}</td>
          <td>{{ booking.seatNumber }}</td>
          <td>₹{{ booking.totalPrice }}</td>
          <td>
            <button *ngIf="!booking.ticketSent"
              class="btn btn-primary btn-sm"
              (click)="sendTicket(booking)">
              Send Ticket
            </button>
            <span *ngIf="booking.ticketSent" class="text-success fw-bold">
              ✔️ Sent
            </span>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="!loading && filteredGroupedBookings.length === 0" class="alert alert-info text-center mt-4">
    No bookings found for the selected filters.
  </div>

</div>
